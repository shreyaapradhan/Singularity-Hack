<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SheSecure - Your Safety Companion</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0f172a;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: #020617;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      max-width: 480px;
      width: 100%;
      overflow: hidden;
    }

    .header {
      background: #020617;
      padding: 30px 30px 20px 30px;
      text-align: center;
      color: white;
      border-bottom: 2px solid #1e293b;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 8px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: #fff;
    }

    .header p {
      font-size: 13px;
      color: #94a3b8;
      line-height: 1.6;
    }

    .shield-icon {
      font-size: 50px;
      margin-bottom: 12px;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .form-container {
      padding: 30px;
      background: #020617;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-group label {
      display: block;
      color: #e2e8f0;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid #1e293b;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s ease;
      background: #0f172a;
      color: #fff;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #2563eb;
      background: #1e293b;
    }

    .form-group input::placeholder {
      color: #64748b;
    }

    .form-group input[disabled] {
      background: #1e293b;
      color: #64748b;
      cursor: not-allowed;
      opacity: 0.6;
    }

    .form-section {
      margin-top: 25px;
      padding-top: 20px;
      border-top: 2px solid #1e293b;
    }

    .form-section-title {
      color: #2563eb;
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .file-input-wrapper {
      position: relative;
      overflow: hidden;
      display: inline-block;
      width: 100%;
    }

    .file-input-wrapper input[type=file] {
      position: absolute;
      left: -9999px;
    }

    .file-input-label {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px 14px;
      background: #0f172a;
      border: 2px dashed #334155;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #64748b;
      font-size: 13px;
    }

    .file-input-label:hover {
      border-color: #2563eb;
      background: #1e293b;
      color: #2563eb;
    }

    .submit-btn {
      width: 100%;
      padding: 14px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 25px;
    }

    .submit-btn:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .info-box {
      background: #1e293b;
      border-left: 4px solid #f59e0b;
      padding: 14px;
      border-radius: 6px;
      margin-top: 20px;
      font-size: 12px;
      color: #cbd5e1;
      line-height: 1.6;
    }

    .required {
      color: #ef4444;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 26px;
      }

      .form-container {
        padding: 25px 20px;
      }
    }
  </style>
</head>

<body>

<div class="container">
  <div class="header">
    <div class="shield-icon">üõ°Ô∏è</div>
    <h1>Raahi</h1>
    <p>Your personal safety companion. Complete your profile to activate emergency features.</p>
  </div>

  <form class="form-container" id="signupForm" onsubmit="handleSubmit(event)">
    <!-- Personal Information -->
    <div class="form-group">
      <label>Full Name <span class="required">*</span></label>
      <input type="text" id="fullname" placeholder="Enter your full name" required>
    </div>

    <div class="form-group">
      <label>Mobile Number <span class="required">*</span></label>
      <input type="tel" id="mobile" placeholder="10-digit mobile number" pattern="[0-9]{10}" required>
    </div>

    <!-- Address Section -->
    <div class="form-section">
      <div class="form-section-title">
        üìç Address Details
      </div>

      <div class="form-group">
        <label>Building / Room No</label>
        <input type="text" id="building" placeholder="Flat no., Building name">
      </div>

      <div class="form-group">
        <label>Street & Area</label>
        <input type="text" id="street" placeholder="Street name, Area">
      </div>

      <div class="form-group">
        <label>State <span class="required">*</span></label>
        <select id="state" required>
          <option value="">Select your state</option>
        </select>
      </div>

      <div class="form-group hidden" id="cityGroup">
        <label>City <span class="required">*</span></label>
        <select id="city" required>
          <option value="">Select your city</option>
        </select>
      </div>

      <div class="form-group">
        <label>Country</label>
        <input type="text" value="India" disabled>
      </div>
    </div>

    <!-- Trusted Contacts Section -->
    <div class="form-section">
      <div class="form-section-title">
        üë• Trusted Emergency Contacts
      </div>

      <div class="form-group">
        <label>Trusted Contact 1</label>
        <input type="tel" id="contact1" placeholder="10-digit mobile number" pattern="[0-9]{10}">
      </div>

      <div class="form-group">
        <label>Trusted Contact 2</label>
        <input type="tel" id="contact2" placeholder="10-digit mobile number" pattern="[0-9]{10}">
      </div>

      <div class="form-group">
        <label>Trusted Contact 3</label>
        <input type="tel" id="contact3" placeholder="10-digit mobile number" pattern="[0-9]{10}">
      </div>
    </div>

    <!-- Photo Upload Section -->
    <div class="form-section">
      <div class="form-section-title">
        üì∑ Identification Photo
      </div>

      <div class="form-group">
        <label>Upload Your Photo (For Authorities)</label>
        <div class="file-input-wrapper">
          <input type="file" id="photo" accept="image/*">
          <label for="photo" class="file-input-label">
            üì§ Click to upload photo
          </label>
        </div>
      </div>
    </div>

    <div class="info-box">
      <strong>üîí Privacy Notice:</strong> Your information is securely stored and will only be shared with emergency contacts and authorities when you activate an alert.
    </div>

    <button type="submit" class="submit-btn">Complete Setup</button>
  </form>
</div>

<script>
  /* ---------- STATE ‚Üí CITY DATA ---------- */
  const states = {
    "Andhra Pradesh": ["Visakhapatnam", "Vijayawada", "Guntur", "Nellore", "Kurnool", "Tirupati"],
    "Arunachal Pradesh": ["Itanagar", "Naharlagun", "Pasighat", "Tawang"],
    "Assam": ["Guwahati", "Silchar", "Dibrugarh", "Jorhat", "Nagaon"],
    "Bihar": ["Patna", "Gaya", "Bhagalpur", "Muzaffarpur", "Darbhanga"],
    "Chhattisgarh": ["Raipur", "Bhilai", "Bilaspur", "Korba", "Durg"],
    "Goa": ["Panaji", "Margao", "Vasco da Gama", "Mapusa"],
    "Gujarat": ["Ahmedabad", "Surat", "Vadodara", "Rajkot", "Bhavnagar", "Jamnagar"],
    "Haryana": ["Faridabad", "Gurgaon", "Panipat", "Ambala", "Karnal"],
    "Himachal Pradesh": ["Shimla", "Dharamshala", "Solan", "Mandi", "Kullu"],
    "Jharkhand": ["Ranchi", "Jamshedpur", "Dhanbad", "Bokaro", "Deoghar"],
    "Karnataka": ["Bengaluru", "Mysuru", "Mangaluru", "Hubballi", "Belagavi"],
    "Kerala": ["Thiruvananthapuram", "Kochi", "Kozhikode", "Thrissur", "Kollam"],
    "Madhya Pradesh": ["Bhopal", "Indore", "Gwalior", "Jabalpur", "Ujjain"],
    "Maharashtra": ["Mumbai", "Pune", "Nagpur", "Thane", "Nashik", "Aurangabad"],
    "Manipur": ["Imphal", "Thoubal", "Churachandpur"],
    "Meghalaya": ["Shillong", "Tura", "Jowai"],
    "Mizoram": ["Aizawl", "Lunglei", "Champhai"],
    "Nagaland": ["Kohima", "Dimapur", "Mokokchung"],
    "Odisha": ["Bhubaneswar", "Cuttack", "Rourkela", "Puri", "Sambalpur"],
    "Punjab": ["Ludhiana", "Amritsar", "Jalandhar", "Patiala", "Bathinda"],
    "Rajasthan": ["Jaipur", "Jodhpur", "Kota", "Udaipur", "Ajmer", "Bikaner"],
    "Sikkim": ["Gangtok", "Namchi", "Gyalshing"],
    "Tamil Nadu": ["Chennai", "Coimbatore", "Madurai", "Tiruchirappalli", "Salem"],
    "Telangana": ["Hyderabad", "Warangal", "Nizamabad", "Khammam"],
    "Tripura": ["Agartala", "Udaipur", "Dharmanagar"],
    "Uttar Pradesh": ["Lucknow", "Kanpur", "Ghaziabad", "Agra", "Varanasi", "Meerut"],
    "Uttarakhand": ["Dehradun", "Haridwar", "Roorkee", "Haldwani"],
    "West Bengal": ["Kolkata", "Howrah", "Durgapur", "Asansol", "Siliguri"],
    "Delhi": ["New Delhi", "North Delhi", "South Delhi", "East Delhi", "West Delhi"],
    "Jammu and Kashmir": ["Srinagar", "Jammu", "Anantnag", "Baramulla"],
    "Ladakh": ["Leh", "Kargil"]
  };

  const stateSel = document.getElementById("state");
  const citySel = document.getElementById("city");
  const cityGroup = document.getElementById("cityGroup");

  // Populate states dropdown
  Object.keys(states).sort().forEach(s => {
    const o = document.createElement("option");
    o.value = s;
    o.text = s;
    stateSel.appendChild(o);
  });

  // Handle state selection
  stateSel.onchange = () => {
    citySel.innerHTML = '<option value="">Select your city</option>';

    if(stateSel.value) {
      cityGroup.classList.remove("hidden");
      states[stateSel.value].forEach(c => {
        const o = document.createElement("option");
        o.value = c;
        o.text = c;
        citySel.appendChild(o);
      });
    } else {
      cityGroup.classList.add("hidden");
    }
  };

  // Update file input label when file is selected
  document.getElementById("photo").addEventListener("change", function(e) {
    const label = document.querySelector(".file-input-label");
    if(e.target.files.length > 0) {
      label.innerHTML = "‚úì " + e.target.files[0].name;
      label.style.borderColor = "#10b981";
      label.style.color = "#10b981";
    }
  });

  /* ---------- FORM SUBMISSION ---------- */
  async function handleSubmit(event) {
    event.preventDefault();

    const formData = {
      fullname: document.getElementById("fullname").value,
      mobile: document.getElementById("mobile").value,
      building: document.getElementById("building").value,
      street: document.getElementById("street").value,
      state: document.getElementById("state").value,
      city: document.getElementById("city").value,
      contact1: document.getElementById("contact1").value,
      contact2: document.getElementById("contact2").value,
      contact3: document.getElementById("contact3").value,
      country: "India"
    };

    try {
      // Send data to backend database
      const response = await fetch('http://localhost:8080/api/users/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
      });

      if (response.ok) {
        alert('‚úì Registration successful! Data saved to database.');

        // Also store in localStorage for frontend use
        localStorage.setItem("sheSecureUserData", JSON.stringify(formData));

        // Redirect to calculator page
        window.location.href = "calc.html";
      } else {
        alert('‚ùå Registration failed. Please try again.');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('‚ùå Network error. Make sure Spring Boot is running on port 8080.');
    }
  }
</script>

</body>
</html>